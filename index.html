<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#1a3c34">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø´ØªØ±ÙƒÙŠÙ†">
    <meta name="description" content="ØªØ·Ø¨ÙŠÙ‚ Ø¥Ø¯Ø§Ø±Ø© Ù…Ø´ØªØ±ÙƒÙŠ Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª - ÙŠØ¹Ù…Ù„ Ø¨Ø¯ÙˆÙ† Ø¥Ù†ØªØ±Ù†Øª">
    <meta name="keywords" content="Ù…Ø´ØªØ±ÙƒÙŠÙ†, Ø¥Ù†ØªØ±Ù†Øª, Ø¥Ø¯Ø§Ø±Ø©, Ø¹Ù…Ù„ Ù…Ø­Ù„ÙŠ">
    <title>Ø¥Ø¯Ø§Ø±Ø© Ù…Ø´ØªØ±ÙƒÙŠ Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª - Ø¹Ù…Ù„ Ù…Ø­Ù„ÙŠ</title>
    
    <link rel="manifest" href="manifest.json">
    <link rel="icon" href="icon-192.png">
    <link rel="apple-touch-icon" href="icon-192.png">

    <style>
        :root {
            --primary-color: #1a3c34;
            --secondary-color: #2a5c50;
            --accent-color: #34a892;
            --light-color: #f5f7fa;
            --dark-color: #2c3e50;
            --success-color: #28a745;
            --warning-color: #ffc107;
            --danger-color: #dc3545;
            --info-color: #17a2b8;
            --border-radius: 12px;
            --box-shadow: 0 6px 20px rgba(0, 0, 0, 0.08);
            --transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #f0f4f7 0%, #e0e8f0 100%);
            min-height: 100vh;
            color: var(--dark-color);
            line-height: 1.6;
            padding: 0;
            margin: 0;
            font-size: 16px;
            overflow-x: hidden;
        }

        /* Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ù€ CSS ÙƒÙ…Ø§ Ù‡Ùˆ ÙÙŠ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø£ØµÙ„ÙŠ */
        /* ÙŠÙ…ÙƒÙ†Ùƒ Ù†Ø³Ø® Ø£Ù†Ù…Ø§Ø· CSS Ù…Ù† Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø£ØµÙ„ÙŠ Ù‡Ù†Ø§ Ø¨Ø¯ÙˆÙ† ØªØºÙŠÙŠØ± */
        /* Ù„ØªØ¬Ù†Ø¨ Ø§Ù„ØªÙƒØ±Ø§Ø±ØŒ Ù„Ù… Ø£Ø¶Ù Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ø§Ù„ÙƒØ§Ù…Ù„Ø© Ù‡Ù†Ø§ØŒ Ù„ÙƒÙ† ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† Ù…Ø·Ø§Ø¨Ù‚Ø© Ù„Ù„ÙƒÙˆØ¯ Ø§Ù„Ø£ØµÙ„ÙŠ */
    </style>
</head>
<body>
    <div id="splash-screen">
        <div class="splash-logo">ğŸ“±</div>
        <div class="splash-text">Ø¥Ø¯Ø§Ø±Ø© Ù…Ø´ØªØ±ÙƒÙŠ Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª</div>
        <div class="splash-loader"></div>
    </div>

    <div class="app-container">
        <!-- Ø¨Ø§Ù‚ÙŠ Ù…Ø­ØªÙˆÙ‰ HTML ÙƒÙ…Ø§ Ù‡Ùˆ ÙÙŠ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø£ØµÙ„ÙŠ -->
        <!-- ÙŠÙ…ÙƒÙ†Ùƒ Ù†Ø³Ø® Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù€ <div class="app-container"> ÙˆÙ…Ø§ Ø¨Ø¯Ø§Ø®Ù„Ù‡ Ù…Ù† Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø£ØµÙ„ÙŠ -->
    </div>

    <div id="notification" class="notification">
        <span>ğŸ””</span>
        <span id="notificationText"></span>
    </div>

    <script>
        // ØªØ¹Ø±ÙŠÙ Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        let subscribers = JSON.parse(localStorage.getItem('subscribers')) || [];
        let currentCurrency = localStorage.getItem('currency') || 'SAR';
        let currentPage = 1;
        const itemsPerPage = 5;
        let deferredPrompt;

        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        function initApp() {
            setTimeout(() => {
                document.getElementById('splash-screen').style.opacity = '0';
                setTimeout(() => {
                    document.getElementById('splash-screen').style.display = 'none';
                    document.querySelector('.app-container').style.display = 'block';
                }, 500);
            }, 1500);

            document.getElementById('startDate').valueAsDate = new Date();
            document.getElementById('currency').value = currentCurrency;
            updateCurrencySymbol();
            displaySubscribers();

            const overdueSubscribers = subscribers.filter(subscriber => {
                const remainingDays = calculateRemainingDays(subscriber.startDate, subscriber.subscriptionDays);
                return remainingDays <= 0;
            });

            if (overdueSubscribers.length > 0) {
                showNotification(`Ù„Ø¯ÙŠÙƒ ${overdueSubscribers.length} Ø§Ø´ØªØ±Ø§Ùƒ Ù…Ù†ØªÙ‡Ù ÙŠØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ ØªØ¬Ø¯ÙŠØ¯`, 'warning');
            }

            // ØªØ³Ø¬ÙŠÙ„ Service Worker
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('/service-worker.js')
                    .then(registration => {
                        console.log('Service Worker registered with scope:', registration.scope);
                    })
                    .catch(error => {
                        console.error('Service Worker registration failed:', error);
                    });
            }

            // Ø¥Ø¸Ù‡Ø§Ø± Ù…ÙˆØ¬Ù‡ Ø§Ù„ØªØ«Ø¨ÙŠØª
            window.addEventListener('beforeinstallprompt', (e) => {
                e.preventDefault();
                deferredPrompt = e;
                const installPrompt = document.getElementById('installPrompt');
                installPrompt.style.display = 'flex';

                document.getElementById('installButton').addEventListener('click', () => {
                    installPrompt.style.display = 'none';
                    deferredPrompt.prompt();
                    deferredPrompt.userChoice.then((choiceResult) => {
                        if (choiceResult.outcome === 'accepted') {
                            console.log('User accepted the install prompt');
                        } else {
                            console.log('User dismissed the install prompt');
                        }
                        deferredPrompt = null;
                    });
                });
            });

            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø§Ù„Ø© Ø§Ù„Ø§ØªØµØ§Ù„
            window.addEventListener('online', () => {
                showNotification('ØªÙ… Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª', 'success');
            });
            window.addEventListener('offline', () => {
                showNotification('Ø£Ù†Øª ÙÙŠ ÙˆØ¶Ø¹ Ø¹Ø¯Ù… Ø§Ù„Ø§ØªØµØ§Ù„', 'warning');
            });
        }

        // Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø¯ÙˆØ§Ù„ (updateDateTime, showNotification, Ø¥Ù„Ø®) ÙƒÙ…Ø§ Ù‡ÙŠ ÙÙŠ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø£ØµÙ„ÙŠ
        // ÙŠÙ…ÙƒÙ†Ùƒ Ù†Ø³Ø® Ø§Ù„Ø¯ÙˆØ§Ù„ Ù…Ù† Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø£ØµÙ„ÙŠ Ù‡Ù†Ø§ Ø¨Ø¯ÙˆÙ† ØªØºÙŠÙŠØ±

        // ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        window.onload = function() {
            updateDateTime();
            setInterval(updateDateTime, 1000);
            initApp();
        };
    </script>
</body>
</html>